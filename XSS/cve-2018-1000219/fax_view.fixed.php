<?php
if (1){
if (1){

//....
/* By M3str3 <namestre3@protonmail.com>
* [ CVE-2018-1000219 ] 
* Vulnerable code: this code is vulnerable because it does not use sanitization */
} else if ($_GET['scan']) {
    $ffname = $GLOBALS['scanner_output_directory'] . '/' . $_GET['scan'];
} else {
    $ffname = $GLOBALS['hylafax_basedir'] . '/recvq/' . $_GET['file'];
}
/*  
* CVE fixed:
* Using FILTER_SANITIZE_STRING can easily fix the CVE */
} else if ($_GET['scan']) {
    $scan = filter_input(INPUT_GET, 'scan', FILTER_SANITIZE_STRING);
    $ffname = $GLOBALS['scanner_output_directory'] . '/' . $scan;
} else {
    $file = filter_input(INPUT_GET, 'file', FILTER_SANITIZE_STRING);
    $ffname = $GLOBALS['hylafax_basedir'] . '/recvq/' . $file;
}
// ...
