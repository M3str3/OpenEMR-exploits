# CVE-2021-41843
Just a script for my TFM

## Description
This script is a proof of concept (PoC) for exploiting the CVE-2021-41843 vulnerability in OpenEMR. The vulnerability allows SQL injection in the OpenEMR calendar module, which can lead to the exposure of sensitive information stored in the system's database.

## Requirements
- Python 3.x
- `requests` library (can be installed with `pip install requests`)

## Usage
The script runs from the command line and requires certain parameters to function correctly. Below are the steps for its execution:

### Arguments
- `-t`, `--target`: Target server IP or domain (required).
- `-s`, `--ssl`: Use HTTPS instead of HTTP.
- `-u`, `--user`: Username for authentication in the OpenEMR system (required).
- `-p`, `--password`: User password for authentication in the OpenEMR system (required).
- `--payload`: SQL injection payload (optional, default: `SELECT CONCAT(username, ':', password) FROM openemr.users_secure WHERE id = 1`).

### Example Command
```shell
python exploit.py -t 192.168.1.100 -u admin -p admin123 --ssl
```
### Script Functionality
- Authentication: The script authenticates to the OpenEMR system using the provided credentials.
- SQL Injection: After authentication, the script sends a POST request to the vulnerable OpenEMR module with an SQL injection payload.
- Response: The script analyzes the server's response to determine if the SQL injection was successful and displays the obtained information.
### Notes
This script is a proof of concept and should only be used for educational purposes and in controlled environments where explicit permission to perform security testing has been obtained. Misuse of this script on unauthorized systems may be illegal and is strictly prohibited.

### Contact
For more information or to report any issues, you can contact the author at namestre3@protonmail.com.

### References
- CVE: https://www.cvedetails.com/cve/CVE-2021-41843/

![Captura de pantalla 2024-07-06 113548](https://github.com/M3str3/OpenEMR-exploits/assets/62236987/d7376cd3-560d-4070-98bf-cd50013f83f2)
